ScreenGui0=Instance.new("ScreenGui");ImageButton1=Instance.new("ImageButton")Frame2=Instance.new("Frame")Frame3=Instance.new("Frame")UIListLayout4=Instance.new("UIListLayout")ImageButton5=Instance.new("ImageButton")ImageButton6=Instance.new("ImageButton")ImageButton7=Instance.new("ImageButton")ImageButton8=Instance.new("ImageButton")ImageButton9=Instance.new("ImageButton")ImageButton10=Instance.new("ImageButton")ImageButton11=Instance.new("ImageButton")ImageButton12=Instance.new("ImageButton")ImageButton13=Instance.new("ImageButton")ImageButton14=Instance.new("ImageButton")ImageLabel15=Instance.new("ImageLabel")Sound16=Instance.new("Sound")ScreenGui0.Name="sgui"ScreenGui0.ZIndexBehavior=Enum.ZIndexBehavior.Sibling;ImageButton1.Name="mframe"ImageButton1.Parent=ScreenGui0;ImageButton1.Position=UDim2.new(0.5,0,1,-100)ImageButton1.Size=UDim2.new(0,256,0,281)ImageButton1.AnchorPoint=Vector2.new(0.5,1)ImageButton1.BackgroundColor3=Color3.new(0.180392,0.180392,0.180392)ImageButton1.BackgroundTransparency=1;ImageButton1.Image="rbxassetid://2790390993"ImageButton1.ImageColor3=Color3.new(0.180392,0.180392,0.180392)ImageButton1.ScaleType=Enum.ScaleType.Slice;ImageButton1.SliceCenter=Rect.new(Vector2.new(16,16),Vector2.new(240,240))Frame2.Name="con"Frame2.Parent=ImageButton1;Frame2.Position=UDim2.new(0.5,0,0.5,0)Frame2.Size=UDim2.new(1,-15,1,-15)Frame2.AnchorPoint=Vector2.new(0.5,0.5)Frame2.BackgroundColor3=Color3.new(1,1,1)Frame2.BackgroundTransparency=1;Frame3.Name="bars"Frame3.Parent=Frame2;Frame3.Position=UDim2.new(0,0,1,0)Frame3.Size=UDim2.new(1,0,0,25)Frame3.AnchorPoint=Vector2.new(0,1)Frame3.BackgroundColor3=Color3.new(1,1,1)Frame3.BackgroundTransparency=1;UIListLayout4.Parent=Frame3;UIListLayout4.FillDirection=Enum.FillDirection.Horizontal;UIListLayout4.HorizontalAlignment=Enum.HorizontalAlignment.Right;UIListLayout4.SortOrder=Enum.SortOrder.LayoutOrder;UIListLayout4.VerticalAlignment=Enum.VerticalAlignment.Center;UIListLayout4.Padding=UDim.new(0.00200000009,4)ImageButton5.Name="v1"ImageButton5.Parent=Frame3;ImageButton5.Size=UDim2.new(0,20,0,25)ImageButton5.BackgroundColor3=Color3.new(1,1,1)ImageButton5.BackgroundTransparency=1;ImageButton5.Image="rbxassetid://2790390993"ImageButton5.ImageColor3=Color3.new(0.478431,0.478431,0.478431)ImageButton5.ScaleType=Enum.ScaleType.Slice;ImageButton5.SliceCenter=Rect.new(Vector2.new(16,16),Vector2.new(240,240))ImageButton6.Name="v2"ImageButton6.Parent=Frame3;ImageButton6.Size=UDim2.new(0,20,0,25)ImageButton6.BackgroundColor3=Color3.new(1,1,1)ImageButton6.BackgroundTransparency=1;ImageButton6.LayoutOrder=1;ImageButton6.Image="rbxassetid://2790390993"ImageButton6.ImageColor3=Color3.new(1,0.501961,0)ImageButton6.ScaleType=Enum.ScaleType.Slice;ImageButton6.SliceCenter=Rect.new(Vector2.new(16,16),Vector2.new(240,240))ImageButton7.Name="v3"ImageButton7.Parent=Frame3;ImageButton7.Size=UDim2.new(0,20,0,25)ImageButton7.BackgroundColor3=Color3.new(1,1,1)ImageButton7.BackgroundTransparency=1;ImageButton7.LayoutOrder=2;ImageButton7.Image="rbxassetid://2790390993"ImageButton7.ImageColor3=Color3.new(1,0.501961,0)ImageButton7.ScaleType=Enum.ScaleType.Slice;ImageButton7.SliceCenter=Rect.new(Vector2.new(16,16),Vector2.new(240,240))ImageButton8.Name="v4"ImageButton8.Parent=Frame3;ImageButton8.Size=UDim2.new(0,20,0,25)ImageButton8.BackgroundColor3=Color3.new(1,1,1)ImageButton8.BackgroundTransparency=1;ImageButton8.LayoutOrder=3;ImageButton8.Image="rbxassetid://2790390993"ImageButton8.ImageColor3=Color3.new(1,0.501961,0)ImageButton8.ScaleType=Enum.ScaleType.Slice;ImageButton8.SliceCenter=Rect.new(Vector2.new(16,16),Vector2.new(240,240))ImageButton9.Name="v5"ImageButton9.Parent=Frame3;ImageButton9.Size=UDim2.new(0,20,0,25)ImageButton9.BackgroundColor3=Color3.new(1,1,1)ImageButton9.BackgroundTransparency=1;ImageButton9.LayoutOrder=4;ImageButton9.Image="rbxassetid://2790390993"ImageButton9.ImageColor3=Color3.new(1,0.501961,0)ImageButton9.ScaleType=Enum.ScaleType.Slice;ImageButton9.SliceCenter=Rect.new(Vector2.new(16,16),Vector2.new(240,240))ImageButton10.Name="v6"ImageButton10.Parent=Frame3;ImageButton10.Size=UDim2.new(0,20,0,25)ImageButton10.BackgroundColor3=Color3.new(1,1,1)ImageButton10.BackgroundTransparency=1;ImageButton10.LayoutOrder=5;ImageButton10.Image="rbxassetid://2790390993"ImageButton10.ImageColor3=Color3.new(1,0.501961,0)ImageButton10.ScaleType=Enum.ScaleType.Slice;ImageButton10.SliceCenter=Rect.new(Vector2.new(16,16),Vector2.new(240,240))ImageButton11.Name="v7"ImageButton11.Parent=Frame3;ImageButton11.Size=UDim2.new(0,20,0,25)ImageButton11.BackgroundColor3=Color3.new(1,1,1)ImageButton11.BackgroundTransparency=1;ImageButton11.LayoutOrder=6;ImageButton11.Image="rbxassetid://2790390993"ImageButton11.ImageColor3=Color3.new(1,0.501961,0)ImageButton11.ScaleType=Enum.ScaleType.Slice;ImageButton11.SliceCenter=Rect.new(Vector2.new(16,16),Vector2.new(240,240))ImageButton12.Name="v8"ImageButton12.Parent=Frame3;ImageButton12.Size=UDim2.new(0,20,0,25)ImageButton12.BackgroundColor3=Color3.new(1,1,1)ImageButton12.BackgroundTransparency=1;ImageButton12.LayoutOrder=7;ImageButton12.Image="rbxassetid://2790390993"ImageButton12.ImageColor3=Color3.new(1,0.501961,0)ImageButton12.ScaleType=Enum.ScaleType.Slice;ImageButton12.SliceCenter=Rect.new(Vector2.new(16,16),Vector2.new(240,240))ImageButton13.Name="v9"ImageButton13.Parent=Frame3;ImageButton13.Size=UDim2.new(0,20,0,25)ImageButton13.BackgroundColor3=Color3.new(1,1,1)ImageButton13.BackgroundTransparency=1;ImageButton13.LayoutOrder=8;ImageButton13.Image="rbxassetid://2790390993"ImageButton13.ImageColor3=Color3.new(1,0.501961,0)ImageButton13.ScaleType=Enum.ScaleType.Slice;ImageButton13.SliceCenter=Rect.new(Vector2.new(16,16),Vector2.new(240,240))ImageButton14.Name="v10"ImageButton14.Parent=Frame3;ImageButton14.Size=UDim2.new(0,20,0,25)ImageButton14.BackgroundColor3=Color3.new(1,1,1)ImageButton14.BackgroundTransparency=1;ImageButton14.LayoutOrder=9;ImageButton14.Image="rbxassetid://2790390993"ImageButton14.ImageColor3=Color3.new(1,0.501961,0)ImageButton14.ScaleType=Enum.ScaleType.Slice;ImageButton14.SliceCenter=Rect.new(Vector2.new(16,16),Vector2.new(240,240))ImageLabel15.Name="speaker"ImageLabel15.Parent=Frame2;ImageLabel15.Size=UDim2.new(1,0,1,0)ImageLabel15.BackgroundColor3=Color3.new(1,1,1)ImageLabel15.BackgroundTransparency=1;ImageLabel15.SizeConstraint=Enum.SizeConstraint.RelativeXX;ImageLabel15.Image="rbxassetid://5251812249"ImageLabel15.ImageRectSize=Vector2.new(512,512)Sound16.Name="volchng"Sound16.Parent=ScreenGui0;Sound16.SoundId="rbxassetid://2587991015"Sound16.Volume=1
local sgui = ScreenGui0
sgui.mframe.con.speaker.Size = UDim2.new(.9,0,.9,0)
sgui.mframe.con.speaker.Position = UDim2.new(.5,0,0,0)
sgui.mframe.con.speaker.AnchorPoint = Vector2.new(.5,0)
local blured_sfx = sgui.mframe.con.speaker:Clone()
blured_sfx.Image = "rbxassetid://5313302761"
blured_sfx.Parent = sgui.mframe.con.speaker
blured_sfx.Name = "speaker_blur"
blured_sfx.Size = UDim2.new(2,0,2,0)
blured_sfx.AnchorPoint = Vector2.new(.5,.5)
blured_sfx.Position = UDim2.new(.5,0,.5,0)
local cur_audio = nil
local tech = Instance.new("TextLabel",sgui.mframe.con.speaker)
tech.Text = ""
tech.BackgroundTransparency = 1
tech.TextScaled = true
tech.Size = UDim2.new(1,0,0,20)
tech.Position = UDim2.new(0,0,1,0)
tech.TextColor3 = Color3.fromRGB(176, 176, 176)
sgui.mframe.ClipsDescendants = true
if game:GetService("RunService"):IsStudio() then
	sgui.Parent = game:GetService("Players").LocalPlayer.PlayerGui
else
	sgui.Parent = game:GetService("CoreGui")
	syn.protect_gui(sgui)
end
local detect_local_sounds = true
local vol = 1
local gfx = 1
local mode = 1
local tsfx
local img = {
 vol = 5251812249,
 gfx = 5256333972
}
function seticn(str)
	sgui.mframe.con.speaker.Image = "rbxassetid://" .. tostring(img[str])
end
local assetinfo = {}
local mps = game:GetService("MarketplaceService")
local numbers = {
	n1 = true,
	n2 = true,
	n3 = true,
	n4 = true,
	n5 = true,
	n6 = true,
	n7 = true,
	n8 = true,
	n9 = true,
	n0 = true
}
function getid_from_string(str)
	local newstr = ""
	for i=1,#str do
		local char = string.sub(str,i,i)
		if numbers["n" .. char] then
			newstr = newstr .. char
		end
	end
	return tonumber(newstr)
end
function get_ainfo(id,obj)
	if id == nil or id == 0 or id == "" then
		return {Name = "No Music Detected"}
	end
	if not assetinfo[id] then
		assetinfo[id] = "bruh"
		print("retrieving audio name for id " .. tostring(id) .. " path: " .. obj:GetFullName())
		assetinfo[id] = mps:GetProductInfo(id)
	end
	if assetinfo[id] == "bruh" then
		repeat game:GetService("RunService").RenderStepped:Wait() until assetinfo[id] ~= "bruh"
	end
	return assetinfo[id]
end
local game_dec = {}
local playing = nil
local last_get_playing = 0
function get_playing()
	local audios = {}
	local t = elapsedTime()
	for i,audio in pairs(game_dec) do
		if audio ~= nil and audio.Parent ~= nil and audio:IsA("Sound") and audio.Playing and audio.Volume > .1 then
			if not audio.Parent:IsA("BasePart") or detect_local_sounds then
				--global sound
				table.insert(audios,audio)
			end
		end
		if elapsedTime()-t>1/240 then
			game:GetService("RunService").RenderStepped:Wait()
			t = elapsedTime()
		end
	end
	local alength = 0
	local got = nil
	for i,audio in pairs(audios) do
		if audio.TimeLength>alength then
			got = audio
			alength = audio.TimeLength
		end
	end
	if got then
		cur_audio = got
		local id = getid_from_string(got.SoundId)
		local ainfo = get_ainfo(id,got)
		return ainfo.Name .. " (" .. tostring(id) .. ")"
	else
		return ""
	end
end
function setvol(newvol)
	if tsfx then
		tsfx:Destroy()
	end
	tsfx = sgui.volchng:Clone()
	tsfx.TimePosition = .1
	tsfx.SoundId = "rbxasset://sounds/electronicpingshort.wav"
	tsfx.Parent = sgui
	tsfx:Play()
	game:GetService("Debris"):AddItem(tsfx,.55)
	
	mode = 1
	vol = math.clamp(newvol,0,10)
	if not game:GetService("RunService"):IsStudio() then
		UserSettings():GetService("UserGameSettings").MasterVolume = vol/10
		local gotplaying = playing
		if elapsedTime()-last_get_playing>1 then
			last_get_playing = elapsedTime()+1000
			playing = get_playing()
			gotplaying = playing
			last_get_playing = elapsedTime()
		end
		if playing then
			tech.Text = tostring(playing)
		end
	end
end
local q = {
	Enum.QualityLevel.Automatic,
	Enum.QualityLevel.Level01,
	Enum.QualityLevel.Level02,
	Enum.QualityLevel.Level03,
	Enum.QualityLevel.Level04,
	Enum.QualityLevel.Level05,
	Enum.QualityLevel.Level06,
	Enum.QualityLevel.Level07,
	Enum.QualityLevel.Level08,
	Enum.QualityLevel.Level09,
	Enum.QualityLevel.Level10,
	Enum.QualityLevel.Level11,
	Enum.QualityLevel.Level12,
	Enum.QualityLevel.Level13,
	Enum.QualityLevel.Level14,
	Enum.QualityLevel.Level15,
	Enum.QualityLevel.Level16,
	Enum.QualityLevel.Level17,
	Enum.QualityLevel.Level18,
	Enum.QualityLevel.Level19,
	Enum.QualityLevel.Level20,
	Enum.QualityLevel.Level21
}
function setgfx(newgfx)
	mode = 2
	gfx = math.clamp(newgfx,0,21)
	if not game:GetService("RunService"):IsStudio() then
		settings():FindService("RenderSettings").QualityLevel = q[gfx+1]
		tech.Text = tostring(settings():FindService("RenderSettings").QualityLevel)
	end
	if tsfx then
		tsfx:Destroy()
	end
	tsfx = sgui.volchng:Clone()
	tsfx.TimePosition = .1
	tsfx.SoundId = "rbxasset://sounds/electronicpingshort.wav"
	tsfx.Parent = sgui
	tsfx:Play()
	game:GetService("Debris"):AddItem(tsfx,.55)
end
function lerp(a,b,t)
	return a * (1-t) + b * t
end
local UIS = game:GetService("UserInputService")
local ui_trans = 1
local speed = 8
local target_trans = 1
local sprite_sheet = {
	vol_low		=	Vector2.new(0,0),
	vol_med		=	Vector2.new(512,0),
	vol_high	=	Vector2.new(0,512),
	vol_muted	=	Vector2.new(512,512)
}
function update_vis(frametime)
	sgui.Enabled = true
	if ui_trans>.99 and target_trans == 1 then
		sgui.Enabled = false
		ui_trans = 1
	end
	if ui_trans<.01 and target_trans == 0 then
		sgui.Enabled = true
		ui_trans = 0
	end
	sgui.mframe.ImageTransparency = ui_trans + .25
	sgui.mframe.con.speaker.ImageTransparency = ui_trans
	sgui.mframe.Size = UDim2.new(0,sgui.mframe.Size.X.Offset,0,281*((ui_trans*-1)+1))
	if mode == 1 then
		if cur_audio then
			local next = ((cur_audio.PlaybackLoudness / 350)*-1)+1
			local last = blured_sfx.ImageTransparency
			blured_sfx.ImageTransparency = lerp(last,next,frametime*25)
		else
			blured_sfx.ImageTransparency = 0
		end
	end
	for _,bar in pairs(sgui.mframe.con.bars:GetChildren()) do
		if bar:IsA("ImageButton") then
			if not tonumber(bar.Name) then
				bar.Name = "25"
			end
			local i = bar.LayoutOrder + 1
			bar.ImageTransparency = ui_trans
			local r,g,b = 0,0,0
			local val = vol
			local real_val = vol
			if mode == 2 then
				seticn("gfx")
				val = math.floor((gfx/21)*10)
				real_val = gfx
			else
				seticn("vol")
			end
			if val >= i then
				r,g,b = 255,128,0
				local rgb = Color3.fromHSV((elapsedTime()/4)%1,1,1)
				r,g,b = rgb.R*255,rgb.G*255,rgb.B*255
			else
				r,g,b = 122,122,122
			end 
			local sizeytar = 25
			if val == i then
				sizeytar = 30
			elseif val > i then
				sizeytar = 25
			else
				sizeytar = 20
			end
			bar.Name = tostring(lerp(tonumber(bar.Name),sizeytar,frametime*16))
			bar.Size = UDim2.new(0,20,0,tonumber(bar.Name))
			bar.ImageColor3 = Color3.fromRGB(r,g,b)
			if mode == 1 then
				blured_sfx.Visible = true
				if real_val == 0 then
					sgui.mframe.con.speaker.ImageRectOffset = sprite_sheet.vol_muted
				end
				if real_val > 0 then
					sgui.mframe.con.speaker.ImageRectOffset = sprite_sheet.vol_low
				end
				if real_val > 4 then
					sgui.mframe.con.speaker.ImageRectOffset = sprite_sheet.vol_med
				end
				if real_val > 7 then
					sgui.mframe.con.speaker.ImageRectOffset = sprite_sheet.vol_high
				end
			else
				blured_sfx.Visible = false
				if real_val == 0 then
					sgui.mframe.con.speaker.ImageRectOffset = sprite_sheet.vol_muted
				end
				if real_val > 0 then
					sgui.mframe.con.speaker.ImageRectOffset = sprite_sheet.vol_low
				end
				if real_val > 10 then
					sgui.mframe.con.speaker.ImageRectOffset = sprite_sheet.vol_med
				end
				if real_val > 19 then
					sgui.mframe.con.speaker.ImageRectOffset = sprite_sheet.vol_high
				end
			end
			blured_sfx.ImageRectOffset = blured_sfx.Parent.ImageRectOffset
		end
	end
end

local ralt_held = false
local lalt_held = false

local ui_shown = false

local last_press = 0

function ui_hide_anim()
	local rs
	local s = elapsedTime()
	target_trans = 1
	ui_shown = false
end

function ui_show_anim()
	if target_trans == 1 then
		game_dec = game:GetDescendants()
	end
	local rs
	local s = elapsedTime()
	target_trans = 0
	ui_shown = true
end

game:GetService("RunService").RenderStepped:Connect(function(ft)
	local dir = (ui_trans-target_trans)
	local dir2 = dir * (1/dir)
	if dir == 0 then
		dir2 = 0
	end
	if dir>0 then
		ui_trans = ui_trans + (dir2 * (ft * speed)) * (dir*-1)
	elseif dir<0 then
		ui_trans = ui_trans + (dir2 * (ft * speed)) * math.abs(dir)
	end
	--print(ui_trans)
	update_vis(ft)
	ralt_held = UIS:IsKeyDown(Enum.KeyCode.RightAlt)
	lalt_held = UIS:IsKeyDown(Enum.KeyCode.LeftAlt)
	if ui_shown and elapsedTime()-last_press>1 then
		ui_hide_anim()
	end
end)

local function volUp()
	last_press = elapsedTime()
	ui_show_anim()
	setvol(vol+1)
end

local function volDown()
	last_press = elapsedTime()
	ui_show_anim()
	setvol(vol-1)
end

local function volMute()
	last_press = elapsedTime()
	ui_show_anim()
	setvol(0)
end

local function gfxUp()
	last_press = elapsedTime()
	ui_show_anim()
	setgfx(gfx+1)
end

local function gfxDown()
	last_press = elapsedTime()
	ui_show_anim()
	setgfx(gfx-1)
end

local function gfxAuto()
	last_press = elapsedTime()
	ui_show_anim()
	setgfx(0)
end


UIS.InputBegan:Connect(function(IO)
	if IO.KeyCode == Enum.KeyCode.Equals and (ralt_held or lalt_held) then
		if lalt_held then
			volUp()
		else
			gfxUp()
		end
	end
	if IO.KeyCode == Enum.KeyCode.Minus and (ralt_held or lalt_held) then
		if lalt_held then
			volDown()
		else
			gfxDown()
		end
	end
end)

_G.rg_vol_gfx_controller = {
	vol = {
		up = volUp,
		down = volDown,
		mute = volMute
	},
	gfx = {
		up = gfxUp,
		down = gfxDown,
		auto = gfxAuto
	}
}
